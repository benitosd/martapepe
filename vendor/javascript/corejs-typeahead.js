import*as t from"jquery";import e from"process";var n=t;try{"default"in t&&(n=t.default)}catch(t){}var i=typeof globalThis!=="undefined"?globalThis:typeof self!=="undefined"?self:global;var r={};var s=e;(function(t,e){r?r=e(n):t.Bloodhound=e(t.jQuery)})(r,(function(t){var e=function(){return{isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return typeof t==="string"},isNumber:function(t){return typeof t==="number"},isArray:t.isArray,isFunction:t.isFunction,isObject:t.isPlainObject,isUndefined:function(t){return typeof t==="undefined"},isElement:function(t){return!!(t&&t.nodeType===1)},isJQuery:function(e){return e instanceof t},toStr:function toStr(t){return e.isUndefined(t)||t===null?"":t+""},bind:t.proxy,each:function(e,n){t.each(e,reverseArgs);function reverseArgs(t,e){return n(e,t)}},map:t.map,filter:t.grep,every:function(e,n){var i=true;if(!e)return i;t.each(e,(function(t,r){if(!(i=n.call(null,r,t,e)))return false}));return!!i},some:function(e,n){var i=false;if(!e)return i;t.each(e,(function(t,r){if(i=n.call(null,r,t,e))return false}));return!!i},mixin:t.extend,identity:function(t){return t},clone:function(e){return t.extend(true,{},e)},getIdGenerator:function(){var t=0;return function(){return t++}},templatify:function templatify(e){return t.isFunction(e)?e:template;function template(){return String(e)}},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var r,s;return function(){var a,o,u=this||i,l=arguments;a=function(){r=null;n||(s=t.apply(u,l))};o=n&&!r;clearTimeout(r);r=setTimeout(a,e);o&&(s=t.apply(u,l));return s}},throttle:function(t,e){var n,r,s,a,o,u;o=0;u=function(){o=new Date;s=null;a=t.apply(n,r)};return function(){var l=new Date,h=e-(l-o);n=this||i;r=arguments;if(h<=0){clearTimeout(s);s=null;o=l;a=t.apply(n,r)}else s||(s=setTimeout(u,h));return a}},stringify:function(t){return e.isString(t)?t:JSON.stringify(t)},guid:function(){function _p8(t){var e=(Math.random().toString(16)+"000000000").substr(2,8);return t?"-"+e.substr(0,4)+"-"+e.substr(4,4):e}return"tt-"+_p8()+_p8(true)+_p8(true)+_p8()},noop:function(){}}}();var n="1.3.3";var r=function(){return{nonword:nonword,whitespace:whitespace,ngram:ngram,obj:{nonword:getObjTokenizer(nonword),whitespace:getObjTokenizer(whitespace),ngram:getObjTokenizer(ngram)}};function whitespace(t){t=e.toStr(t);return t?t.split(/\s+/):[]}function nonword(t){t=e.toStr(t);return t?t.split(/\W+/):[]}function ngram(t){t=e.toStr(t);var n=[],i="";e.each(t.split(""),(function(t){if(t.match(/\s+/))i="";else{n.push(i+t);i+=t}}));return n}function getObjTokenizer(t){return function setKey(n){n=e.isArray(n)?n:[].slice.call(arguments,0);return function tokenize(i){var r=[];e.each(n,(function(n){r=r.concat(t(e.toStr(i[n])))}));return r}}}}();var s=function(){function LruCache(n){(this||i).maxSize=e.isNumber(n)?n:100;this.reset();(this||i).maxSize<=0&&((this||i).set=(this||i).get=t.noop)}e.mixin(LruCache.prototype,{set:function set(t,e){var n,r=(this||i).list.tail;if((this||i).size>=(this||i).maxSize){(this||i).list.remove(r);delete(this||i).hash[r.key];(this||i).size--}if(n=(this||i).hash[t]){n.val=e;(this||i).list.moveToFront(n)}else{n=new Node(t,e);(this||i).list.add(n);(this||i).hash[t]=n;(this||i).size++}},get:function get(t){var e=(this||i).hash[t];if(e){(this||i).list.moveToFront(e);return e.val}},reset:function reset(){(this||i).size=0;(this||i).hash={};(this||i).list=new List}});function List(){(this||i).head=(this||i).tail=null}e.mixin(List.prototype,{add:function add(t){if((this||i).head){t.next=(this||i).head;(this||i).head.prev=t}(this||i).head=t;(this||i).tail=(this||i).tail||t},remove:function remove(t){t.prev?t.prev.next=t.next:(this||i).head=t.next;t.next?t.next.prev=t.prev:(this||i).tail=t.prev},moveToFront:function(t){this.remove(t);this.add(t)}});function Node(t,e){(this||i).key=t;(this||i).val=e;(this||i).prev=(this||i).next=null}return LruCache}();var a=function(){var n;try{n=window.localStorage;n.setItem("~~~","!");n.removeItem("~~~")}catch(t){n=null}function PersistentStorage(t,r){(this||i).prefix=["__",t,"__"].join("");(this||i).ttlKey="__ttl__";(this||i).keyMatcher=new RegExp("^"+e.escapeRegExChars((this||i).prefix));(this||i).ls=r||n;!(this||i).ls&&this._noop()}e.mixin(PersistentStorage.prototype,{_prefix:function(t){return(this||i).prefix+t},_ttlKey:function(t){return this._prefix(t)+(this||i).ttlKey},_noop:function(){(this||i).get=(this||i).set=(this||i).remove=(this||i).clear=(this||i).isExpired=e.noop},_safeSet:function(t,e){try{(this||i).ls.setItem(t,e)}catch(t){if(t.name==="QuotaExceededError"){this.clear();this._noop()}}},get:function(t){this.isExpired(t)&&this.remove(t);return decode((this||i).ls.getItem(this._prefix(t)))},set:function(t,n,r){e.isNumber(r)?this._safeSet(this._ttlKey(t),encode(now()+r)):(this||i).ls.removeItem(this._ttlKey(t));return this._safeSet(this._prefix(t),encode(n))},remove:function(t){(this||i).ls.removeItem(this._ttlKey(t));(this||i).ls.removeItem(this._prefix(t));return this||i},clear:function(){var t,e=gatherMatchingKeys((this||i).keyMatcher);for(t=e.length;t--;)this.remove(e[t]);return this||i},isExpired:function(t){var n=decode((this||i).ls.getItem(this._ttlKey(t)));return!!(e.isNumber(n)&&now()>n)}});return PersistentStorage;function now(){return(new Date).getTime()}function encode(t){return JSON.stringify(e.isUndefined(t)?null:t)}function decode(e){return t.parseJSON(e)}function gatherMatchingKeys(t){var e,i,r=[],s=n.length;for(e=0;e<s;e++)(i=n.key(e)).match(t)&&r.push(i.replace(t,""));return r}}();var o=function(){var n=0,r={},a=new s(10);function Transport(t){t=t||{};(this||i).maxPendingRequests=t.maxPendingRequests||6;(this||i).cancelled=false;(this||i).lastReq=null;(this||i)._send=t.transport;(this||i)._get=t.limiter?t.limiter((this||i)._get):(this||i)._get;(this||i)._cache=t.cache===false?new s(0):a}Transport.setMaxPendingRequests=function setMaxPendingRequests(t){(this||i).maxPendingRequests=t};Transport.resetCache=function resetCache(){a.reset()};e.mixin(Transport.prototype,{_fingerprint:function fingerprint(e){e=e||{};return e.url+e.type+t.param(e.data||{})},_get:function(t,e){var s,a,o=this||i;s=this._fingerprint(t);if(!(this||i).cancelled&&s===(this||i).lastReq)if(a=r[s])a.done(done).fail(fail);else if(n<(this||i).maxPendingRequests){n++;r[s]=this._send(t).done(done).fail(fail).always(always)}else(this||i).onDeckRequestArgs=[].slice.call(arguments,0);function done(t){e(null,t);o._cache.set(s,t)}function fail(){e(true)}function always(){n--;delete r[s];if(o.onDeckRequestArgs){o._get.apply(o,o.onDeckRequestArgs);o.onDeckRequestArgs=null}}},get:function(n,r){var s,a;r=r||t.noop;n=e.isString(n)?{url:n}:n||{};a=this._fingerprint(n);(this||i).cancelled=false;(this||i).lastReq=a;(s=(this||i)._cache.get(a))?r(null,s):this._get(n,r)},cancel:function(){(this||i).cancelled=true}});return Transport}();var u=window.SearchIndex=function(){var n="c",r="i";function SearchIndex(n){n=n||{};n.datumTokenizer&&n.queryTokenizer||t.error("datumTokenizer and queryTokenizer are both required");(this||i).identify=n.identify||e.stringify;(this||i).datumTokenizer=n.datumTokenizer;(this||i).queryTokenizer=n.queryTokenizer;(this||i).matchAnyQueryToken=n.matchAnyQueryToken;this.reset()}e.mixin(SearchIndex.prototype,{bootstrap:function bootstrap(t){(this||i).datums=t.datums;(this||i).trie=t.trie},add:function(t){var s=this||i;t=e.isArray(t)?t:[t];e.each(t,(function(t){var i,a;s.datums[i=s.identify(t)]=t;a=normalizeTokens(s.datumTokenizer(t));e.each(a,(function(t){var e,a,o;e=s.trie;a=t.split("");while(o=a.shift()){e=e[n][o]||(e[n][o]=newNode());e[r].push(i)}}))}))},get:function get(t){var n=this||i;return e.map(t,(function(t){return n.datums[t]}))},search:function search(t){var s,a,o=this||i;s=normalizeTokens(this.queryTokenizer(t));e.each(s,(function(t){var e,i,s,u;if(a&&a.length===0&&!o.matchAnyQueryToken)return false;e=o.trie;i=t.split("");while(e&&(s=i.shift()))e=e[n][s];if(e&&i.length===0){u=e[r].slice(0);a=a?getIntersection(a,u):u}else if(!o.matchAnyQueryToken){a=[];return false}}));return a?e.map(unique(a),(function(t){return o.datums[t]})):[]},all:function all(){var t=[];for(var e in(this||i).datums)t.push((this||i).datums[e]);return t},reset:function reset(){(this||i).datums={};(this||i).trie=newNode()},serialize:function serialize(){return{datums:(this||i).datums,trie:(this||i).trie}}});return SearchIndex;function normalizeTokens(t){t=e.filter(t,(function(t){return!!t}));t=e.map(t,(function(t){return t.toLowerCase()}));return t}function newNode(){var t={};t[r]=[];t[n]={};return t}function unique(t){var e={},n=[];for(var i=0,r=t.length;i<r;i++)if(!e[t[i]]){e[t[i]]=true;n.push(t[i])}return n}function getIntersection(t,e){var n=0,i=0,r=[];t=t.sort();e=e.sort();var s=t.length,a=e.length;while(n<s&&i<a)if(t[n]<e[i])n++;else if(t[n]>e[i])i++;else{r.push(t[n]);n++;i++}return r}}();var l=function(){var t;t={data:"data",protocol:"protocol",thumbprint:"thumbprint"};function Prefetch(t){(this||i).url=t.url;(this||i).ttl=t.ttl;(this||i).cache=t.cache;(this||i).prepare=t.prepare;(this||i).transform=t.transform;(this||i).transport=t.transport;(this||i).thumbprint=t.thumbprint;(this||i).storage=new a(t.cacheKey)}e.mixin(Prefetch.prototype,{_settings:function settings(){return{url:(this||i).url,type:"GET",dataType:"json"}},store:function store(e){if((this||i).cache){(this||i).storage.set(t.data,e,(this||i).ttl);(this||i).storage.set(t.protocol,location.protocol,(this||i).ttl);(this||i).storage.set(t.thumbprint,(this||i).thumbprint,(this||i).ttl)}},fromCache:function fromCache(){var e,n={};if(!(this||i).cache)return null;n.data=(this||i).storage.get(t.data);n.protocol=(this||i).storage.get(t.protocol);n.thumbprint=(this||i).storage.get(t.thumbprint);e=n.thumbprint!==(this||i).thumbprint||n.protocol!==location.protocol;return n.data&&!e?n.data:null},fromNetwork:function(t){var e,n=this||i;if(t){e=this.prepare(this._settings());this.transport(e).fail(onError).done(onResponse)}function onError(){t(true)}function onResponse(e){t(null,n.transform(e))}},clear:function clear(){(this||i).storage.clear();return this||i}});return Prefetch}();var h=function(){function Remote(t){(this||i).url=t.url;(this||i).prepare=t.prepare;(this||i).transform=t.transform;(this||i).indexResponse=t.indexResponse;(this||i).transport=new o({cache:t.cache,limiter:t.limiter,transport:t.transport,maxPendingRequests:t.maxPendingRequests})}e.mixin(Remote.prototype,{_settings:function settings(){return{url:(this||i).url,type:"GET",dataType:"json"}},get:function get(t,e){var n,r=this||i;if(e){t=t||"";n=this.prepare(t,this._settings());return(this||i).transport.get(n,onResponse)}function onResponse(t,n){e(t?[]:r.transform(n))}},cancelLastRequest:function cancelLastRequest(){(this||i).transport.cancel()}});return Remote}();var d=function(){return function parse(n){var i,r;i={initialize:true,identify:e.stringify,datumTokenizer:null,queryTokenizer:null,matchAnyQueryToken:false,sufficient:5,indexRemote:false,sorter:null,local:[],prefetch:null,remote:null};n=e.mixin(i,n||{});!n.datumTokenizer&&t.error("datumTokenizer is required");!n.queryTokenizer&&t.error("queryTokenizer is required");r=n.sorter;n.sorter=r?function(t){return t.sort(r)}:e.identity;n.local=e.isFunction(n.local)?n.local():n.local;n.prefetch=parsePrefetch(n.prefetch);n.remote=parseRemote(n.remote);return n};function parsePrefetch(i){var r;if(!i)return null;r={url:null,ttl:864e5,cache:true,cacheKey:null,thumbprint:"",prepare:e.identity,transform:e.identity,transport:null};i=e.isString(i)?{url:i}:i;i=e.mixin(r,i);!i.url&&t.error("prefetch requires url to be set");i.transform=i.filter||i.transform;i.cacheKey=i.cacheKey||i.url;i.thumbprint=n+i.thumbprint;i.transport=i.transport?callbackToDeferred(i.transport):t.ajax;return i}function parseRemote(n){var i;if(n){i={url:null,cache:true,prepare:null,replace:null,wildcard:null,limiter:null,rateLimitBy:"debounce",rateLimitWait:300,transform:e.identity,transport:null};n=e.isString(n)?{url:n}:n;n=e.mixin(i,n);!n.url&&t.error("remote requires url to be set");n.transform=n.filter||n.transform;n.prepare=toRemotePrepare(n);n.limiter=toLimiter(n);n.transport=n.transport?callbackToDeferred(n.transport):t.ajax;delete n.replace;delete n.wildcard;delete n.rateLimitBy;delete n.rateLimitWait;return n}}function toRemotePrepare(t){var e,n,i;e=t.prepare;n=t.replace;i=t.wildcard;if(e)return e;e=n?prepareByReplace:t.wildcard?prepareByWildcard:identityPrepare;return e;function prepareByReplace(t,e){e.url=n(e.url,t);return e}function prepareByWildcard(t,e){e.url=e.url.replace(i,encodeURIComponent(t));return e}function identityPrepare(t,e){return e}}function toLimiter(t){var n,i,r;n=t.limiter;i=t.rateLimitBy;r=t.rateLimitWait;n||(n=/^throttle$/i.test(i)?throttle(r):debounce(r));return n;function debounce(t){return function debounce(n){return e.debounce(n,t)}}function throttle(t){return function throttle(n){return e.throttle(n,t)}}}function callbackToDeferred(n){return function wrapper(i){var r=t.Deferred();n(i,onSuccess,onError);return r;function onSuccess(t){e.defer((function(){r.resolve(t)}))}function onError(t){e.defer((function(){r.reject(t)}))}}}}();var f=function(){var n;n=window&&window.Bloodhound;function Bloodhound(t){t=d(t);(this||i).sorter=t.sorter;(this||i).identify=t.identify;(this||i).sufficient=t.sufficient;(this||i).indexRemote=t.indexRemote;(this||i).local=t.local;(this||i).remote=t.remote?new h(t.remote):null;(this||i).prefetch=t.prefetch?new l(t.prefetch):null;(this||i).index=new u({identify:(this||i).identify,datumTokenizer:t.datumTokenizer,queryTokenizer:t.queryTokenizer});t.initialize!==false&&this.initialize()}Bloodhound.noConflict=function noConflict(){window&&(window.Bloodhound=n);return Bloodhound};Bloodhound.tokenizers=r;e.mixin(Bloodhound.prototype,{__ttAdapter:function ttAdapter(){var t=this||i;return(this||i).remote?withAsync:withoutAsync;function withAsync(e,n,i){return t.search(e,n,i)}function withoutAsync(e,n){return t.search(e,n)}},_loadPrefetch:function loadPrefetch(){var e,n,r=this||i;e=t.Deferred();if((this||i).prefetch)if(n=(this||i).prefetch.fromCache()){(this||i).index.bootstrap(n);e.resolve()}else(this||i).prefetch.fromNetwork(done);else e.resolve();return e.promise();function done(t,n){if(t)return e.reject();r.add(n);r.prefetch.store(r.index.serialize());e.resolve()}},_initialize:function initialize(){var t=this||i;this.clear();((this||i).initPromise=this._loadPrefetch()).done(addLocalToIndex);return(this||i).initPromise;function addLocalToIndex(){t.add(t.local)}},initialize:function initialize(t){return!(this||i).initPromise||t?this._initialize():(this||i).initPromise},add:function add(t){(this||i).index.add(t);return this||i},get:function get(t){t=e.isArray(t)?t:[].slice.call(arguments);return(this||i).index.get(t)},search:function search(t,n,r){var s,a=this||i;n=n||e.noop;r=r||e.noop;s=this.sorter((this||i).index.search(t));n((this||i).remote?s.slice():s);(this||i).remote&&s.length<(this||i).sufficient?(this||i).remote.get(t,processRemote):(this||i).remote&&(this||i).remote.cancelLastRequest();return this||i;function processRemote(t){var n=[];e.each(t,(function(t){!e.some(s,(function(e){return a.identify(t)===a.identify(e)}))&&n.push(t)}));a.indexRemote&&a.add(n);r(n)}},all:function all(){return(this||i).index.all()},clear:function clear(){(this||i).index.reset();return this||i},clearPrefetchCache:function clearPrefetchCache(){(this||i).prefetch&&(this||i).prefetch.clear();return this||i},clearRemoteCache:function clearRemoteCache(){o.resetCache();return this||i},ttAdapter:function ttAdapter(){return this.__ttAdapter()}});return Bloodhound}();return f}));(function(t,e){r?r=e(n):e(t.jQuery)})(r,(function(t){var e=function(){return{isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return typeof t==="string"},isNumber:function(t){return typeof t==="number"},isArray:t.isArray,isFunction:t.isFunction,isObject:t.isPlainObject,isUndefined:function(t){return typeof t==="undefined"},isElement:function(t){return!!(t&&t.nodeType===1)},isJQuery:function(e){return e instanceof t},toStr:function toStr(t){return e.isUndefined(t)||t===null?"":t+""},bind:t.proxy,each:function(e,n){t.each(e,reverseArgs);function reverseArgs(t,e){return n(e,t)}},map:t.map,filter:t.grep,every:function(e,n){var i=true;if(!e)return i;t.each(e,(function(t,r){if(!(i=n.call(null,r,t,e)))return false}));return!!i},some:function(e,n){var i=false;if(!e)return i;t.each(e,(function(t,r){if(i=n.call(null,r,t,e))return false}));return!!i},mixin:t.extend,identity:function(t){return t},clone:function(e){return t.extend(true,{},e)},getIdGenerator:function(){var t=0;return function(){return t++}},templatify:function templatify(e){return t.isFunction(e)?e:template;function template(){return String(e)}},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var r,s;return function(){var a,o,u=this||i,l=arguments;a=function(){r=null;n||(s=t.apply(u,l))};o=n&&!r;clearTimeout(r);r=setTimeout(a,e);o&&(s=t.apply(u,l));return s}},throttle:function(t,e){var n,r,s,a,o,u;o=0;u=function(){o=new Date;s=null;a=t.apply(n,r)};return function(){var l=new Date,h=e-(l-o);n=this||i;r=arguments;if(h<=0){clearTimeout(s);s=null;o=l;a=t.apply(n,r)}else s||(s=setTimeout(u,h));return a}},stringify:function(t){return e.isString(t)?t:JSON.stringify(t)},guid:function(){function _p8(t){var e=(Math.random().toString(16)+"000000000").substr(2,8);return t?"-"+e.substr(0,4)+"-"+e.substr(4,4):e}return"tt-"+_p8()+_p8(true)+_p8(true)+_p8()},noop:function(){}}}();var n=function(){var t={wrapper:"twitter-typeahead",input:"tt-input",hint:"tt-hint",menu:"tt-menu",dataset:"tt-dataset",suggestion:"tt-suggestion",selectable:"tt-selectable",empty:"tt-empty",open:"tt-open",cursor:"tt-cursor",highlight:"tt-highlight"};return build;function build(n){var i,r;r=e.mixin({},t,n);i={css:buildCss(),classes:r,html:buildHtml(r),selectors:buildSelectors(r)};return{css:i.css,html:i.html,classes:i.classes,selectors:i.selectors,mixin:function(t){e.mixin(t,i)}}}function buildHtml(t){return{wrapper:'<span class="'+t.wrapper+'"></span>',menu:'<div role="listbox" class="'+t.menu+'"></div>'}}function buildSelectors(t){var n={};e.each(t,(function(t,e){n[e]="."+t}));return n}function buildCss(){var t={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},menu:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};e.isMsie()&&e.mixin(t.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"});return t}}();var r=function(){var n,r;n="typeahead:";r={render:"rendered",cursorchange:"cursorchanged",select:"selected",autocomplete:"autocompleted"};function EventBus(e){e&&e.el||t.error("EventBus initialized without el");(this||i).$el=t(e.el)}e.mixin(EventBus.prototype,{_trigger:function(e,r){var s=t.Event(n+e);(this||i).$el.trigger.call((this||i).$el,s,r||[]);return s},before:function(t){var e,n;e=[].slice.call(arguments,1);n=this._trigger("before"+t,e);return n.isDefaultPrevented()},trigger:function(t){var e;this._trigger(t,[].slice.call(arguments,1));(e=r[t])&&this._trigger(e,[].slice.call(arguments,1))}});return EventBus}();var a=function(){var t=/\s+/,e=getNextTick();return{onSync:onSync,onAsync:onAsync,off:off,trigger:trigger};function on(e,n,r,s){var a;if(!r)return this||i;n=n.split(t);r=s?bindContext(r,s):r;(this||i)._callbacks=(this||i)._callbacks||{};while(a=n.shift()){(this||i)._callbacks[a]=(this||i)._callbacks[a]||{sync:[],async:[]};(this||i)._callbacks[a][e].push(r)}return this||i}function onAsync(t,e,n){return on.call(this||i,"async",t,e,n)}function onSync(t,e,n){return on.call(this||i,"sync",t,e,n)}function off(e){var n;if(!(this||i)._callbacks)return this||i;e=e.split(t);while(n=e.shift())delete(this||i)._callbacks[n];return this||i}function trigger(n){var r,s,a,o,u;if(!(this||i)._callbacks)return this||i;n=n.split(t);a=[].slice.call(arguments,1);while((r=n.shift())&&(s=(this||i)._callbacks[r])){o=getFlush(s.sync,this||i,[r].concat(a));u=getFlush(s.async,this||i,[r].concat(a));o()&&e(u)}return this||i}function getFlush(t,e,n){return flush;function flush(){var i;for(var r=0,s=t.length;!i&&r<s;r+=1)i=t[r].apply(e,n)===false;return!i}}function getNextTick(){var t;t=window.setImmediate?function nextTickSetImmediate(t){s.nextTick((function(){t()}))}:function nextTickSetTimeout(t){setTimeout((function(){t()}),0)};return t}function bindContext(t,e){return t.bind?t.bind(e):function(){t.apply(e,[].slice.call(arguments,0))}}}();var o=function(t){var n={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:false,caseSensitive:false,diacriticInsensitive:false};var i={A:"[AaªÀ-Åà-åĀ-ąǍǎȀ-ȃȦȧᴬᵃḀḁẚẠ-ảₐ℀℁℻⒜Ⓐⓐ㍱-㍴㎀-㎄㎈㎉㎩-㎯㏂㏊㏟㏿Ａａ]",B:"[BbᴮᵇḂ-ḇℬ⒝Ⓑⓑ㍴㎅-㎇㏃㏈㏔㏝Ｂｂ]",C:"[CcÇçĆ-čᶜ℀ℂ℃℅℆ℭⅭⅽ⒞Ⓒⓒ㍶㎈㎉㎝㎠㎤㏄-㏇Ｃｃ]",D:"[DdĎďǄ-ǆǱ-ǳᴰᵈḊ-ḓⅅⅆⅮⅾ⒟Ⓓⓓ㋏㍲㍷-㍹㎗㎭-㎯㏅㏈Ｄｄ]",E:"[EeÈ-Ëè-ëĒ-ěȄ-ȇȨȩᴱᵉḘ-ḛẸ-ẽₑ℡ℯℰⅇ⒠Ⓔⓔ㉐㋍㋎Ｅｅ]",F:"[FfᶠḞḟ℉ℱ℻⒡Ⓕⓕ㎊-㎌㎙ﬀ-ﬄＦｆ]",G:"[GgĜ-ģǦǧǴǵᴳᵍḠḡℊ⒢Ⓖⓖ㋌㋍㎇㎍-㎏㎓㎬㏆㏉㏒㏿Ｇｇ]",H:"[HhĤĥȞȟʰᴴḢ-ḫẖℋ-ℎ⒣Ⓗⓗ㋌㍱㎐-㎔㏊㏋㏗Ｈｈ]",I:"[IiÌ-Ïì-ïĨ-İĲĳǏǐȈ-ȋᴵᵢḬḭỈ-ịⁱℐℑℹⅈⅠ-ⅣⅥ-ⅨⅪⅫⅰ-ⅳⅵ-ⅸⅺⅻ⒤Ⓘⓘ㍺㏌㏕ﬁﬃＩｉ]",J:"[JjĲ-ĵǇ-ǌǰʲᴶⅉ⒥ⒿⓙⱼＪｊ]",K:"[KkĶķǨǩᴷᵏḰ-ḵK⒦Ⓚⓚ㎄㎅㎉㎏㎑㎘㎞㎢㎦㎪㎸㎾㏀㏆㏍-㏏Ｋｋ]",L:"[LlĹ-ŀǇ-ǉˡᴸḶḷḺ-ḽℒℓ℡Ⅼⅼ⒧Ⓛⓛ㋏㎈㎉㏐-㏓㏕㏖㏿ﬂﬄＬｌ]",M:"[MmᴹᵐḾ-ṃ℠™ℳⅯⅿ⒨Ⓜⓜ㍷-㍹㎃㎆㎎㎒㎖㎙-㎨㎫㎳㎷㎹㎽㎿㏁㏂㏎㏐㏔-㏖㏘㏙㏞㏟Ｍｍ]",N:"[NnÑñŃ-ŉǊ-ǌǸǹᴺṄ-ṋⁿℕ№⒩Ⓝⓝ㎁㎋㎚㎱㎵㎻㏌㏑Ｎｎ]",O:"[OoºÒ-Öò-öŌ-őƠơǑǒǪǫȌ-ȏȮȯᴼᵒỌ-ỏₒ℅№ℴ⒪Ⓞⓞ㍵㏇㏒㏖Ｏｏ]",P:"[PpᴾᵖṔ-ṗℙ⒫Ⓟⓟ㉐㍱㍶㎀㎊㎩-㎬㎰㎴㎺㏋㏗-㏚Ｐｐ]",Q:"[Qqℚ⒬Ⓠⓠ㏃Ｑｑ]",R:"[RrŔ-řȐ-ȓʳᴿᵣṘ-ṛṞṟ₨ℛ-ℝ⒭Ⓡⓡ㋍㍴㎭-㎯㏚㏛Ｒｒ]",S:"[SsŚ-šſȘșˢṠ-ṣ₨℁℠⒮Ⓢⓢ㎧㎨㎮-㎳㏛㏜ﬆＳｓ]",T:"[TtŢ-ťȚțᵀᵗṪ-ṱẗ℡™⒯Ⓣⓣ㉐㋏㎔㏏ﬅﬆＴｔ]",U:"[UuÙ-Üù-üŨ-ųƯưǓǔȔ-ȗᵁᵘᵤṲ-ṷỤ-ủ℆⒰Ⓤⓤ㍳㍺Ｕｕ]",V:"[VvᵛᵥṼ-ṿⅣ-Ⅷⅳ-ⅷ⒱Ⓥⓥⱽ㋎㍵㎴-㎹㏜㏞Ｖｖ]",W:"[WwŴŵʷᵂẀ-ẉẘ⒲Ⓦⓦ㎺-㎿㏝Ｗｗ]",X:"[XxˣẊ-ẍₓ℻Ⅸ-Ⅻⅸ-ⅻ⒳Ⓧⓧ㏓Ｘｘ]",Y:"[YyÝýÿŶ-ŸȲȳʸẎẏẙỲ-ỹ⒴Ⓨⓨ㏉Ｙｙ]",Z:"[ZzŹ-žǱ-ǳᶻẐ-ẕℤℨ⒵Ⓩⓩ㎐-㎔Ｚｚ]"};return function hightlight(i){var r;i=e.mixin({},n,i);if(i.node&&i.pattern){i.pattern=e.isArray(i.pattern)?i.pattern:[i.pattern];r=getRegex(i.pattern,i.caseSensitive,i.wordsOnly,i.diacriticInsensitive);traverse(i.node,hightlightTextNode)}function hightlightTextNode(e){var n,s,a;if(n=r.exec(e.data)){a=t.createElement(i.tagName);i.className&&(a.className=i.className);s=e.splitText(n.index);s.splitText(n[0].length);a.appendChild(s.cloneNode(true));e.parentNode.replaceChild(a,s)}return!!n}function traverse(t,e){var n,i=3;for(var r=0;r<t.childNodes.length;r++){n=t.childNodes[r];n.nodeType===i?r+=e(n)?1:0:traverse(n,e)}}};function accent_replacer(t){return i[t.toUpperCase()]||t}function getRegex(t,n,i,r){var s,a=[];for(var o=0,u=t.length;o<u;o++){var l=e.escapeRegExChars(t[o]);r&&(l=l.replace(/\S/g,accent_replacer));a.push(l)}s=i?"\\b("+a.join("|")+")\\b":"("+a.join("|")+")";return n?new RegExp(s):new RegExp(s,"i")}}(window.document);var u=function(){var n;n={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"};function Input(n,r){var s;n=n||{};n.input||t.error("input is missing");r.mixin(this||i);(this||i).$hint=t(n.hint);(this||i).$input=t(n.input);(this||i).$menu=t(n.menu);s=(this||i).$input.attr("id")||e.guid();(this||i).$menu.attr("id",s+"_listbox");(this||i).$hint.attr({"aria-hidden":true});(this||i).$input.attr({"aria-owns":s+"_listbox","aria-controls":s+"_listbox",role:"combobox","aria-autocomplete":"list","aria-expanded":false});(this||i).query=(this||i).$input.val();(this||i).queryWhenFocused=this.hasFocus()?(this||i).query:null;(this||i).$overflowHelper=buildOverflowHelper((this||i).$input);this._checkLanguageDirection();(this||i).$hint.length===0&&((this||i).setHint=(this||i).getHint=(this||i).clearHint=(this||i).clearHintIfInvalid=e.noop);this.onSync("cursorchange",(this||i)._updateDescendent)}Input.normalizeQuery=function(t){return e.toStr(t).replace(/^\s*/g,"").replace(/\s{2,}/g," ")};e.mixin(Input.prototype,a,{_onBlur:function onBlur(){this.resetInputValue();this.trigger("blurred")},_onFocus:function onFocus(){(this||i).queryWhenFocused=(this||i).query;this.trigger("focused")},_onKeydown:function onKeydown(t){var e=n[t.which||t.keyCode];this._managePreventDefault(e,t);e&&this._shouldTrigger(e,t)&&this.trigger(e+"Keyed",t)},_onInput:function onInput(){this._setQuery(this.getInputValue());this.clearHintIfInvalid();this._checkLanguageDirection()},_managePreventDefault:function managePreventDefault(t,e){var n;switch(t){case"up":case"down":n=!withModifier(e);break;default:n=false}n&&e.preventDefault()},_shouldTrigger:function shouldTrigger(t,e){var n;switch(t){case"tab":n=!withModifier(e);break;default:n=true}return n},_checkLanguageDirection:function checkLanguageDirection(){var t=((this||i).$input.css("direction")||"ltr").toLowerCase();if((this||i).dir!==t){(this||i).dir=t;(this||i).$hint.attr("dir",t);this.trigger("langDirChanged",t)}},_setQuery:function setQuery(t,e){var n,r;n=areQueriesEquivalent(t,(this||i).query);r=!!n&&(this||i).query.length!==t.length;(this||i).query=t;e||n?!e&&r&&this.trigger("whitespaceChanged",(this||i).query):this.trigger("queryChanged",(this||i).query)},_updateDescendent:function updateDescendent(t,e){(this||i).$input.attr("aria-activedescendant",e)},bind:function(){var t,r,s,a,o=this||i;t=e.bind((this||i)._onBlur,this||i);r=e.bind((this||i)._onFocus,this||i);s=e.bind((this||i)._onKeydown,this||i);a=e.bind((this||i)._onInput,this||i);(this||i).$input.on("blur.tt",t).on("focus.tt",r).on("keydown.tt",s);!e.isMsie()||e.isMsie()>9?(this||i).$input.on("input.tt",a):(this||i).$input.on("keydown.tt keypress.tt cut.tt paste.tt",(function(t){n[t.which||t.keyCode]||e.defer(e.bind(o._onInput,o,t))}));return this||i},focus:function focus(){(this||i).$input.focus()},blur:function blur(){(this||i).$input.blur()},getLangDir:function getLangDir(){return(this||i).dir},getQuery:function getQuery(){return(this||i).query||""},setQuery:function setQuery(t,e){this.setInputValue(t);this._setQuery(t,e)},hasQueryChangedSinceLastFocus:function hasQueryChangedSinceLastFocus(){return(this||i).query!==(this||i).queryWhenFocused},getInputValue:function getInputValue(){return(this||i).$input.val()},setInputValue:function setInputValue(t){(this||i).$input.val(t);this.clearHintIfInvalid();this._checkLanguageDirection()},resetInputValue:function resetInputValue(){this.setInputValue((this||i).query)},getHint:function getHint(){return(this||i).$hint.val()},setHint:function setHint(t){(this||i).$hint.val(t)},clearHint:function clearHint(){this.setHint("")},clearHintIfInvalid:function clearHintIfInvalid(){var t,e,n,i;t=this.getInputValue();e=this.getHint();n=t!==e&&e.indexOf(t)===0;i=t!==""&&n&&!this.hasOverflow();!i&&this.clearHint()},hasFocus:function hasFocus(){return(this||i).$input.is(":focus")},hasOverflow:function hasOverflow(){var t=(this||i).$input.width()-2;(this||i).$overflowHelper.text(this.getInputValue());return(this||i).$overflowHelper.width()>=t},isCursorAtEnd:function(){var t,n,r;t=(this||i).$input.val().length;n=(this||i).$input[0].selectionStart;if(e.isNumber(n))return n===t;if(document.selection){r=document.selection.createRange();r.moveStart("character",-t);return t===r.text.length}return true},destroy:function destroy(){(this||i).$hint.off(".tt");(this||i).$input.off(".tt");(this||i).$overflowHelper.remove();(this||i).$hint=(this||i).$input=(this||i).$overflowHelper=t("<div>")},setAriaExpanded:function setAriaExpanded(t){(this||i).$input.attr("aria-expanded",t)}});return Input;function buildOverflowHelper(e){return t('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:e.css("font-family"),fontSize:e.css("font-size"),fontStyle:e.css("font-style"),fontVariant:e.css("font-variant"),fontWeight:e.css("font-weight"),wordSpacing:e.css("word-spacing"),letterSpacing:e.css("letter-spacing"),textIndent:e.css("text-indent"),textRendering:e.css("text-rendering"),textTransform:e.css("text-transform")}).insertAfter(e)}function areQueriesEquivalent(t,e){return Input.normalizeQuery(t)===Input.normalizeQuery(e)}function withModifier(t){return t.altKey||t.ctrlKey||t.metaKey||t.shiftKey}}();var l=function(){var n,r;n={dataset:"tt-selectable-dataset",val:"tt-selectable-display",obj:"tt-selectable-object"};r=e.getIdGenerator();function Dataset(n,s){n=n||{};n.templates=n.templates||{};n.templates.notFound=n.templates.notFound||n.templates.empty;n.source||t.error("missing source");n.node||t.error("missing node");n.name&&!isValidName(n.name)&&t.error("invalid dataset name: "+n.name);s.mixin(this||i);(this||i).highlight=!!n.highlight;(this||i).name=e.toStr(n.name||r());(this||i).limit=n.limit||5;(this||i).displayFn=getDisplayFn(n.display||n.displayKey);(this||i).templates=getTemplates(n.templates,(this||i).displayFn);(this||i).source=n.source.__ttAdapter?n.source.__ttAdapter():n.source;(this||i).async=e.isUndefined(n.async)?(this||i).source.length>2:!!n.async;this._resetLastSuggestion();(this||i).$el=t(n.node).attr("role","presentation").addClass((this||i).classes.dataset).addClass((this||i).classes.dataset+"-"+(this||i).name)}Dataset.extractData=function extractData(e){var i=t(e);return i.data(n.obj)?{dataset:i.data(n.dataset)||"",val:i.data(n.val)||"",obj:i.data(n.obj)||null}:null};e.mixin(Dataset.prototype,a,{_overwrite:function overwrite(t,e){e=e||[];e.length?this._renderSuggestions(t,e):(this||i).async&&(this||i).templates.pending?this._renderPending(t):!(this||i).async&&(this||i).templates.notFound?this._renderNotFound(t):this._empty();this.trigger("rendered",e,false,(this||i).name)},_append:function append(t,e){e=e||[];e.length&&(this||i).$lastSuggestion.length?this._appendSuggestions(t,e):e.length?this._renderSuggestions(t,e):!(this||i).$lastSuggestion.length&&(this||i).templates.notFound&&this._renderNotFound(t);this.trigger("rendered",e,true,(this||i).name)},_renderSuggestions:function renderSuggestions(t,e){var n;n=this._getSuggestionsFragment(t,e);(this||i).$lastSuggestion=n.children().last();(this||i).$el.html(n).prepend(this._getHeader(t,e)).append(this._getFooter(t,e))},_appendSuggestions:function appendSuggestions(t,e){var n,r;n=this._getSuggestionsFragment(t,e);r=n.children().last();(this||i).$lastSuggestion.after(n);(this||i).$lastSuggestion=r},_renderPending:function renderPending(t){var e=(this||i).templates.pending;this._resetLastSuggestion();e&&(this||i).$el.html(e({query:t,dataset:(this||i).name}))},_renderNotFound:function renderNotFound(t){var e=(this||i).templates.notFound;this._resetLastSuggestion();e&&(this||i).$el.html(e({query:t,dataset:(this||i).name}))},_empty:function empty(){(this||i).$el.empty();this._resetLastSuggestion()},_getSuggestionsFragment:function getSuggestionsFragment(r,s){var a,u=this||i;a=document.createDocumentFragment();e.each(s,(function getSuggestionNode(e){var i,s;s=u._injectQuery(r,e);i=t(u.templates.suggestion(s)).data(n.dataset,u.name).data(n.obj,e).data(n.val,u.displayFn(e)).addClass(u.classes.suggestion+" "+u.classes.selectable);a.appendChild(i[0])}));(this||i).highlight&&o({className:(this||i).classes.highlight,node:a,pattern:r});return t(a)},_getFooter:function getFooter(t,e){return(this||i).templates.footer?(this||i).templates.footer({query:t,suggestions:e,dataset:(this||i).name}):null},_getHeader:function getHeader(t,e){return(this||i).templates.header?(this||i).templates.header({query:t,suggestions:e,dataset:(this||i).name}):null},_resetLastSuggestion:function resetLastSuggestion(){(this||i).$lastSuggestion=t()},_injectQuery:function injectQuery(t,n){return e.isObject(n)?e.mixin({_query:t},n):n},update:function update(e){var n=this||i,r=false,s=false,a=0;this.cancel();(this||i).cancel=function cancel(){r=true;n.cancel=t.noop;n.async&&n.trigger("asyncCanceled",e,n.name)};this.source(e,sync,async);!s&&sync([]);function sync(t){if(!s){s=true;t=(t||[]).slice(0,n.limit);a=t.length;n._overwrite(e,t);a<n.limit&&n.async&&n.trigger("asyncRequested",e,n.name)}}function async(i){i=i||[];if(!r&&a<n.limit){n.cancel=t.noop;var s=Math.abs(a-n.limit);a+=s;n._append(e,i.slice(0,s));n.async&&n.trigger("asyncReceived",e,n.name)}}},cancel:t.noop,clear:function clear(){this._empty();this.cancel();this.trigger("cleared")},isEmpty:function isEmpty(){return(this||i).$el.is(":empty")},destroy:function destroy(){(this||i).$el=t("<div>")}});return Dataset;function getDisplayFn(t){t=t||e.stringify;return e.isFunction(t)?t:displayFn;function displayFn(e){return e[t]}}function getTemplates(n,i){return{notFound:n.notFound&&e.templatify(n.notFound),pending:n.pending&&e.templatify(n.pending),header:n.header&&e.templatify(n.header),footer:n.footer&&e.templatify(n.footer),suggestion:n.suggestion?userSuggestionTemplate:suggestionTemplate};function userSuggestionTemplate(i){var r=n.suggestion;return t(r(i)).attr("id",e.guid())}function suggestionTemplate(n){return t('<div role="option">').attr("id",e.guid()).text(i(n))}}function isValidName(t){return/^[_a-zA-Z0-9-]+$/.test(t)}}();var h=function(){function Menu(n,r){var s=this||i;n=n||{};n.node||t.error("node is required");r.mixin(this||i);(this||i).$node=t(n.node);(this||i).query=null;(this||i).datasets=e.map(n.datasets,initializeDataset);function initializeDataset(e){var n=s.$node.find(e.node).first();e.node=n.length?n:t("<div>").appendTo(s.$node);return new l(e,r)}}e.mixin(Menu.prototype,a,{_onSelectableClick:function onSelectableClick(e){this.trigger("selectableClicked",t(e.currentTarget))},_onRendered:function onRendered(t,e,n,r){(this||i).$node.toggleClass((this||i).classes.empty,this._allDatasetsEmpty());this.trigger("datasetRendered",e,n,r)},_onCleared:function onCleared(){(this||i).$node.toggleClass((this||i).classes.empty,this._allDatasetsEmpty());this.trigger("datasetCleared")},_propagate:function propagate(){(this||i).trigger.apply(this||i,arguments)},_allDatasetsEmpty:function allDatasetsEmpty(){return e.every((this||i).datasets,e.bind((function isDatasetEmpty(t){var e=t.isEmpty();(this||i).$node.attr("aria-expanded",!e);return e}),this||i))},_getSelectables:function getSelectables(){return(this||i).$node.find((this||i).selectors.selectable)},_removeCursor:function _removeCursor(){var t=this.getActiveSelectable();t&&t.removeClass((this||i).classes.cursor)},_ensureVisible:function ensureVisible(t){var e,n,r,s;e=t.position().top;n=e+t.outerHeight(true);r=(this||i).$node.scrollTop();s=(this||i).$node.height()+parseInt((this||i).$node.css("paddingTop"),10)+parseInt((this||i).$node.css("paddingBottom"),10);e<0?(this||i).$node.scrollTop(r+e):s<n&&(this||i).$node.scrollTop(r+(n-s))},bind:function(){var n,r=this||i;n=e.bind((this||i)._onSelectableClick,this||i);(this||i).$node.on("click.tt",(this||i).selectors.selectable,n);(this||i).$node.on("mouseover",(this||i).selectors.selectable,(function(){r.setCursor(t(this||i))}));(this||i).$node.on("mouseleave",(function(){r._removeCursor()}));e.each((this||i).datasets,(function(t){t.onSync("asyncRequested",r._propagate,r).onSync("asyncCanceled",r._propagate,r).onSync("asyncReceived",r._propagate,r).onSync("rendered",r._onRendered,r).onSync("cleared",r._onCleared,r)}));return this||i},isOpen:function isOpen(){return(this||i).$node.hasClass((this||i).classes.open)},open:function open(){(this||i).$node.scrollTop(0);(this||i).$node.addClass((this||i).classes.open)},close:function close(){(this||i).$node.attr("aria-expanded",false);(this||i).$node.removeClass((this||i).classes.open);this._removeCursor()},setLanguageDirection:function setLanguageDirection(t){(this||i).$node.attr("dir",t)},selectableRelativeToCursor:function selectableRelativeToCursor(t){var e,n,i,r;n=this.getActiveSelectable();e=this._getSelectables();i=n?e.index(n):-1;r=i+t;r=(r+1)%(e.length+1)-1;r=r<-1?e.length-1:r;return r===-1?null:e.eq(r)},setCursor:function setCursor(t){this._removeCursor();if(t=t&&t.first()){t.addClass((this||i).classes.cursor);this._ensureVisible(t)}},getSelectableData:function getSelectableData(t){return t&&t.length?l.extractData(t):null},getActiveSelectable:function getActiveSelectable(){var t=this._getSelectables().filter((this||i).selectors.cursor).first();return t.length?t:null},getTopSelectable:function getTopSelectable(){var t=this._getSelectables().first();return t.length?t:null},update:function update(t){var n=t!==(this||i).query;if(n){(this||i).query=t;e.each((this||i).datasets,updateDataset)}return n;function updateDataset(e){e.update(t)}},empty:function empty(){e.each((this||i).datasets,clearDataset);(this||i).query=null;(this||i).$node.addClass((this||i).classes.empty);function clearDataset(t){t.clear()}},destroy:function destroy(){(this||i).$node.off(".tt");(this||i).$node=t("<div>");e.each((this||i).datasets,destroyDataset);function destroyDataset(t){t.destroy()}}});return Menu}();var d=function(){function Status(n){(this||i).$el=t("<span></span>",{role:"status","aria-live":"polite"}).css({position:"absolute",padding:"0",border:"0",height:"1px",width:"1px","margin-bottom":"-1px","margin-right":"-1px",overflow:"hidden",clip:"rect(0 0 0 0)","white-space":"nowrap"});n.$input.after((this||i).$el);e.each(n.menu.datasets,e.bind((function(t){if(t.onSync){t.onSync("rendered",e.bind((this||i).update,this||i));t.onSync("cleared",e.bind((this||i).cleared,this||i))}}),this||i))}e.mixin(Status.prototype,{update:function update(t,e){var n=e.length;var r;r=n===1?{result:"result",is:"is"}:{result:"results",is:"are"};(this||i).$el.text(n+" "+r.result+" "+r.is+" available, use up and down arrow keys to navigate.")},cleared:function(){(this||i).$el.text("")}});return Status}();var f=function(){var t=h.prototype;function DefaultMenu(){h.apply(this||i,[].slice.call(arguments,0))}e.mixin(DefaultMenu.prototype,h.prototype,{open:function open(){!this._allDatasetsEmpty()&&this._show();return t.open.apply(this||i,[].slice.call(arguments,0))},close:function close(){this._hide();return t.close.apply(this||i,[].slice.call(arguments,0))},_onRendered:function onRendered(){this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show();return t._onRendered.apply(this||i,[].slice.call(arguments,0))},_onCleared:function onCleared(){this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show();return t._onCleared.apply(this||i,[].slice.call(arguments,0))},setLanguageDirection:function setLanguageDirection(e){(this||i).$node.css(e==="ltr"?(this||i).css.ltr:(this||i).css.rtl);return t.setLanguageDirection.apply(this||i,[].slice.call(arguments,0))},_hide:function hide(){(this||i).$node.hide()},_show:function show(){(this||i).$node.css("display","block")}});return DefaultMenu}();var p=function(){function Typeahead(n,r){var s,a,o,u,l,h,d,f,p,g,m;n=n||{};n.input||t.error("missing input");n.menu||t.error("missing menu");n.eventBus||t.error("missing event bus");r.mixin(this||i);(this||i).eventBus=n.eventBus;(this||i).minLength=e.isNumber(n.minLength)?n.minLength:1;(this||i).input=n.input;(this||i).menu=n.menu;(this||i).enabled=true;(this||i).autoselect=!!n.autoselect;(this||i).active=false;(this||i).input.hasFocus()&&this.activate();(this||i).dir=(this||i).input.getLangDir();this._hacks();(this||i).menu.bind().onSync("selectableClicked",(this||i)._onSelectableClicked,this||i).onSync("asyncRequested",(this||i)._onAsyncRequested,this||i).onSync("asyncCanceled",(this||i)._onAsyncCanceled,this||i).onSync("asyncReceived",(this||i)._onAsyncReceived,this||i).onSync("datasetRendered",(this||i)._onDatasetRendered,this||i).onSync("datasetCleared",(this||i)._onDatasetCleared,this||i);s=c(this||i,"activate","open","_onFocused");a=c(this||i,"deactivate","_onBlurred");o=c(this||i,"isActive","isOpen","_onEnterKeyed");u=c(this||i,"isActive","isOpen","_onTabKeyed");l=c(this||i,"isActive","_onEscKeyed");h=c(this||i,"isActive","open","_onUpKeyed");d=c(this||i,"isActive","open","_onDownKeyed");f=c(this||i,"isActive","isOpen","_onLeftKeyed");p=c(this||i,"isActive","isOpen","_onRightKeyed");g=c(this||i,"_openIfActive","_onQueryChanged");m=c(this||i,"_openIfActive","_onWhitespaceChanged");(this||i).input.bind().onSync("focused",s,this||i).onSync("blurred",a,this||i).onSync("enterKeyed",o,this||i).onSync("tabKeyed",u,this||i).onSync("escKeyed",l,this||i).onSync("upKeyed",h,this||i).onSync("downKeyed",d,this||i).onSync("leftKeyed",f,this||i).onSync("rightKeyed",p,this||i).onSync("queryChanged",g,this||i).onSync("whitespaceChanged",m,this||i).onSync("langDirChanged",(this||i)._onLangDirChanged,this||i)}e.mixin(Typeahead.prototype,{_hacks:function hacks(){var n,r;n=(this||i).input.$input||t("<div>");r=(this||i).menu.$node||t("<div>");n.on("blur.tt",(function(t){var i,s,a;i=document.activeElement;s=r.is(i);a=r.has(i).length>0;if(e.isMsie()&&(s||a)){t.preventDefault();t.stopImmediatePropagation();e.defer((function(){n.focus()}))}}));r.on("mousedown.tt",(function(t){t.preventDefault()}))},_onSelectableClicked:function onSelectableClicked(t,e){this.select(e)},_onDatasetCleared:function onDatasetCleared(){this._updateHint()},_onDatasetRendered:function onDatasetRendered(t,e,n,r){this._updateHint();if((this||i).autoselect){var s=(this||i).selectors.cursor.substr(1);(this||i).menu.$node.find((this||i).selectors.suggestion).first().addClass(s)}(this||i).eventBus.trigger("render",e,n,r)},_onAsyncRequested:function onAsyncRequested(t,e,n){(this||i).eventBus.trigger("asyncrequest",n,e)},_onAsyncCanceled:function onAsyncCanceled(t,e,n){(this||i).eventBus.trigger("asynccancel",n,e)},_onAsyncReceived:function onAsyncReceived(t,e,n){(this||i).eventBus.trigger("asyncreceive",n,e)},_onFocused:function onFocused(){this._minLengthMet()&&(this||i).menu.update((this||i).input.getQuery())},_onBlurred:function onBlurred(){(this||i).input.hasQueryChangedSinceLastFocus()&&(this||i).eventBus.trigger("change",(this||i).input.getQuery())},_onEnterKeyed:function onEnterKeyed(t,e){var n;if(n=(this||i).menu.getActiveSelectable()){if(this.select(n)){e.preventDefault();e.stopPropagation()}}else if((this||i).autoselect&&this.select((this||i).menu.getTopSelectable())){e.preventDefault();e.stopPropagation()}},_onTabKeyed:function onTabKeyed(t,e){var n;(n=(this||i).menu.getActiveSelectable())?this.select(n)&&e.preventDefault():(this||i).autoselect&&(n=(this||i).menu.getTopSelectable())&&this.autocomplete(n)&&e.preventDefault()},_onEscKeyed:function onEscKeyed(){this.close()},_onUpKeyed:function onUpKeyed(){this.moveCursor(-1)},_onDownKeyed:function onDownKeyed(){this.moveCursor(1)},_onLeftKeyed:function onLeftKeyed(){(this||i).dir==="rtl"&&(this||i).input.isCursorAtEnd()&&this.autocomplete((this||i).menu.getActiveSelectable()||(this||i).menu.getTopSelectable())},_onRightKeyed:function onRightKeyed(){(this||i).dir==="ltr"&&(this||i).input.isCursorAtEnd()&&this.autocomplete((this||i).menu.getActiveSelectable()||(this||i).menu.getTopSelectable())},_onQueryChanged:function onQueryChanged(t,e){this._minLengthMet(e)?(this||i).menu.update(e):(this||i).menu.empty()},_onWhitespaceChanged:function onWhitespaceChanged(){this._updateHint()},_onLangDirChanged:function onLangDirChanged(t,e){if((this||i).dir!==e){(this||i).dir=e;(this||i).menu.setLanguageDirection(e)}},_openIfActive:function openIfActive(){this.isActive()&&this.open()},_minLengthMet:function minLengthMet(t){t=e.isString(t)?t:(this||i).input.getQuery()||"";return t.length>=(this||i).minLength},_updateHint:function updateHint(){var t,n,r,s,a,o,l;t=(this||i).menu.getTopSelectable();n=(this||i).menu.getSelectableData(t);r=(this||i).input.getInputValue();if(!n||e.isBlankString(r)||(this||i).input.hasOverflow())(this||i).input.clearHint();else{s=u.normalizeQuery(r);a=e.escapeRegExChars(s);o=new RegExp("^(?:"+a+")(.+$)","i");l=o.exec(n.val);l&&(this||i).input.setHint(r+l[1])}},isEnabled:function isEnabled(){return(this||i).enabled},enable:function enable(){(this||i).enabled=true},disable:function disable(){(this||i).enabled=false},isActive:function isActive(){return(this||i).active},activate:function activate(){if(this.isActive())return true;if(!this.isEnabled()||(this||i).eventBus.before("active"))return false;(this||i).active=true;(this||i).eventBus.trigger("active");return true},deactivate:function deactivate(){if(this.isActive()){if((this||i).eventBus.before("idle"))return false;(this||i).active=false;this.close();(this||i).eventBus.trigger("idle");return true}return true},isOpen:function isOpen(){return(this||i).menu.isOpen()},open:function open(){if(!this.isOpen()&&!(this||i).eventBus.before("open")){(this||i).input.setAriaExpanded(true);(this||i).menu.open();this._updateHint();(this||i).eventBus.trigger("open")}return this.isOpen()},close:function close(){if(this.isOpen()&&!(this||i).eventBus.before("close")){(this||i).input.setAriaExpanded(false);(this||i).menu.close();(this||i).input.clearHint();(this||i).input.resetInputValue();(this||i).eventBus.trigger("close")}return!this.isOpen()},setVal:function setVal(t){(this||i).input.setQuery(e.toStr(t))},getVal:function getVal(){return(this||i).input.getQuery()},select:function select(t){var e=(this||i).menu.getSelectableData(t);if(e&&!(this||i).eventBus.before("select",e.obj,e.dataset)){(this||i).input.setQuery(e.val,true);(this||i).eventBus.trigger("select",e.obj,e.dataset);this.close();return true}return false},autocomplete:function autocomplete(t){var e,n,r;e=(this||i).input.getQuery();n=(this||i).menu.getSelectableData(t);r=n&&e!==n.val;if(r&&!(this||i).eventBus.before("autocomplete",n.obj,n.dataset)){(this||i).input.setQuery(n.val);(this||i).eventBus.trigger("autocomplete",n.obj,n.dataset);return true}return false},moveCursor:function moveCursor(t){var e,n,r,s,a,o,u;e=(this||i).input.getQuery();n=(this||i).menu.selectableRelativeToCursor(t);r=(this||i).menu.getSelectableData(n);s=r?r.obj:null;a=r?r.dataset:null;u=n?n.attr("id"):null;(this||i).input.trigger("cursorchange",u);o=this._minLengthMet()&&(this||i).menu.update(e);if(!o&&!(this||i).eventBus.before("cursorchange",s,a)){(this||i).menu.setCursor(n);if(r)typeof r.val==="string"&&(this||i).input.setInputValue(r.val);else{(this||i).input.resetInputValue();this._updateHint()}(this||i).eventBus.trigger("cursorchange",s,a);return true}return false},destroy:function destroy(){(this||i).input.destroy();(this||i).menu.destroy()}});return Typeahead;function c(t){var n=[].slice.call(arguments,1);return function(){var i=[].slice.call(arguments);e.each(n,(function(e){return t[e].apply(t,i)}))}}}();(function(){var s,a,o;s=t.fn.typeahead;a={www:"tt-www",attrs:"tt-attrs",typeahead:"tt-typeahead"};o={initialize:function initialize(s,o){var l;o=e.isArray(o)?o:[].slice.call(arguments,1);s=s||{};l=n(s.classNames);return this.each(attach);function attach(){var n,g,m,y,v,b,_,S,w,x,A;e.each(o,(function(t){t.highlight=!!s.highlight}));n=t(this||i);g=t(l.html.wrapper);m=$elOrNull(s.hint);y=$elOrNull(s.menu);v=s.hint!==false&&!m;b=s.menu!==false&&!y;v&&(m=buildHintFromInput(n,l));b&&(y=t(l.html.menu).css(l.css.menu));m&&m.val("");n=prepInput(n,l);if(v||b){g.css(l.css.wrapper);n.css(v?l.css.input:l.css.inputWithNoHint);n.wrap(g).parent().prepend(v?m:null).append(b?y:null)}A=b?f:h;_=new r({el:n});S=new u({hint:m,input:n,menu:y},l);w=new A({node:y,datasets:o},l);new d({$input:n,menu:w});x=new p({input:S,menu:w,eventBus:_,minLength:s.minLength,autoselect:s.autoselect},l);n.data(a.www,l);n.data(a.typeahead,x)}},isEnabled:function isEnabled(){var t;ttEach(this.first(),(function(e){t=e.isEnabled()}));return t},enable:function enable(){ttEach(this||i,(function(t){t.enable()}));return this||i},disable:function disable(){ttEach(this||i,(function(t){t.disable()}));return this||i},isActive:function isActive(){var t;ttEach(this.first(),(function(e){t=e.isActive()}));return t},activate:function activate(){ttEach(this||i,(function(t){t.activate()}));return this||i},deactivate:function deactivate(){ttEach(this||i,(function(t){t.deactivate()}));return this||i},isOpen:function isOpen(){var t;ttEach(this.first(),(function(e){t=e.isOpen()}));return t},open:function open(){ttEach(this||i,(function(t){t.open()}));return this||i},close:function close(){ttEach(this||i,(function(t){t.close()}));return this||i},select:function select(e){var n=false,i=t(e);ttEach(this.first(),(function(t){n=t.select(i)}));return n},autocomplete:function autocomplete(e){var n=false,i=t(e);ttEach(this.first(),(function(t){n=t.autocomplete(i)}));return n},moveCursor:function moveCursoe(t){var e=false;ttEach(this.first(),(function(n){e=n.moveCursor(t)}));return e},val:function val(t){var n;if(arguments.length){ttEach(this||i,(function(n){n.setVal(e.toStr(t))}));return this||i}ttEach(this.first(),(function(t){n=t.getVal()}));return n},destroy:function destroy(){ttEach(this||i,(function(t,e){revert(e);t.destroy()}));return this||i}};t.fn.typeahead=function(t){return o[t]?o[t].apply(this||i,[].slice.call(arguments,1)):o.initialize.apply(this||i,arguments)};t.fn.typeahead.noConflict=function noConflict(){t.fn.typeahead=s;return this||i};function ttEach(e,n){e.each((function(){var e,r=t(this||i);(e=r.data(a.typeahead))&&n(e,r)}))}function buildHintFromInput(t,e){return t.clone().addClass(e.classes.hint).removeData().css(e.css.hint).css(getBackgroundStyles(t)).prop({readonly:true,required:false}).removeAttr("id name placeholder").removeClass("required").attr({spellcheck:"false",tabindex:-1})}function prepInput(t,e){t.data(a.attrs,{dir:t.attr("dir"),autocomplete:t.attr("autocomplete"),spellcheck:t.attr("spellcheck"),style:t.attr("style")});t.addClass(e.classes.input).attr({spellcheck:false});try{!t.attr("dir")&&t.attr("dir","auto")}catch(t){}return t}function getBackgroundStyles(t){return{backgroundAttachment:t.css("background-attachment"),backgroundClip:t.css("background-clip"),backgroundColor:t.css("background-color"),backgroundImage:t.css("background-image"),backgroundOrigin:t.css("background-origin"),backgroundPosition:t.css("background-position"),backgroundRepeat:t.css("background-repeat"),backgroundSize:t.css("background-size")}}function revert(t){var n,i;n=t.data(a.www);i=t.parent().filter(n.selectors.wrapper);e.each(t.data(a.attrs),(function(n,i){e.isUndefined(n)?t.removeAttr(i):t.attr(i,n)}));t.removeData(a.typeahead).removeData(a.www).removeData(a.attr).removeClass(n.classes.input);if(i.length){t.detach().insertAfter(i);i.remove()}}function $elOrNull(n){var i,r;i=e.isJQuery(n)||e.isElement(n);r=i?t(n).first():[];return r.length?r:null}})()}));var a=r;export{a as default};

